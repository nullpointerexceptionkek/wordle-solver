See code comments in src/index.js